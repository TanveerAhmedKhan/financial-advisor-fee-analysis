# Financial Advisor Fee Data Analysis

This repository contains Python scripts for cleaning, analyzing, and visualizing fee data from financial advisors' regulatory filings (Form ADV brochures and Part 2 forms).

## Overview

The analysis focuses on understanding fee structures, minimum investments, and negotiability of fees across financial advisors from 2007 to 2023. The data was extracted from regulatory filings using LLM (Large Language Model) and then verified.

## GitHub Repository

This project is hosted on GitHub at: [https://github.com/TanveerAhmedKhan/financial-advisor-fee-analysis](https://github.com/TanveerAhmedKhan/financial-advisor-fee-analysis)

**Note on Large Data Files**: Due to GitHub's file size limitations (100MB), the consolidated data files (`cleaned_fee_data_ordered.csv` and `cleaned_fee_data_with_products.csv`) are not included in the repository. These files can be generated by running the data processing pipeline locally.

## Repository Structure

```
financial-advisor-fee-analysis/
│
├── data/                      # Data directory
│   ├── raw/                   # Raw CSV files extracted from regulatory filings (not in repository)
│   └── processed/             # Cleaned and processed data files
│       ├── [individual processed CSV files]  # Individual processed files
│       ├── cleaned_fee_data_ordered.csv  # All processed records with original order preserved (not in repository)
│       └── cleaned_fee_data_with_products.csv   # Final output with product structure analysis (not in repository)
│
├── src/                       # Source code
│   ├── process_csv_files.py                     # Step 1: Process CSV files individually
│   ├── combine_processed_files.py               # Step 2: Combine processed files into consolidated datasets
│   └── add_product_structure.py                 # Step 3: Add product structure analysis
│
├── .gitignore                 # Git ignore file
├── README.md                  # This file
└── requirements.txt           # Python dependencies
```

## Detailed Analysis

### Fee Structure Distribution

The analysis shows that the majority of financial advisors use AUM-based fee structures rather than flat fees. Based on the processed data, approximately 88.9% of advisers use AUM-based fee structures, while 11.1% use flat fees.

### Fee Structure Evolution (2011-2023)

The proportion of advisers using flat fee structures has shown a gradual increase over the past decade:

| Year | AUM-based | Flat Fee |
|------|-----------|----------|
| 2011 | 89.70%    | 10.30%   |
| 2015 | 88.42%    | 11.58%   |
| 2019 | 88.29%    | 11.71%   |
| 2023 | 87.52%    | 12.48%   |

This data shows the trend of fee structures over time, with a slight increase in the proportion of advisors using flat fee structures.

### Effective Fee Trends

Effective fees have remained remarkably stable over time, with slight variations:

| Year | $1M Portfolio | $5M Portfolio |
|------|---------------|---------------|
| 2011 | 1.07%         | 0.89%         |
| 2015 | 1.06%         | 0.91%         |
| 2019 | 1.05%         | 0.91%         |
| 2023 | 1.07%         | 0.92%         |

The data shows that effective fees have remained remarkably consistent over the years, with a concentration around 1% for $1M portfolios and slightly lower (around 0.9%) for $5M portfolios.

### Fee Reduction by Portfolio Size

The analysis shows that larger portfolios benefit from lower effective fees:

- **Average Reduction**: 13.0% lower fees for $5M vs. $1M portfolios
- **Median Reduction**: 10.8% lower fees
- **Range**: 0% to 79.5% reduction (excluding outliers)

This tiered pricing structure is consistent across most advisors, with fee percentages decreasing as investment amounts increase.

### Multiple Products Analysis

When advisers offer multiple products, they typically have distinct fee structures:

- **2 Products**: 7,383 advisers (7.7% of those with fee information)
- **3+ Products**: 2,151 advisers (2.2% of those with fee information)

The vast majority of advisers (90.1%) offer a single fee structure, making it easier for clients to understand their pricing model.

### Minimum Investment Distribution

The distribution of minimum investment amounts is highly skewed:

- **25th Percentile**: $14,000
- **Median**: $250,000
- **75th Percentile**: $1,000,000
- **Maximum**: $4 billion

As shown in our analysis, only about 20.1% of advisors specify a minimum investment requirement, with the majority not imposing any minimum threshold for clients.

### Negotiable Fees

The proportion of advisers with negotiable fees provides insight into fee flexibility. Based on the analysis, 61.6% of advisers indicate their fees are negotiable, providing flexibility for clients, while 38.4% have non-negotiable fee structures.

### Data Quality

The data quality has been significantly improved through:

1. Standardized column structure across all processed files
2. Consistent handling of missing data
3. Proper extraction of adviser IDs and filing dates
4. Elimination of duplicate records while preserving unique advisers

## Key Findings

### Fee Structure Analysis

1. **Fee Structure Types**:
   - 88.9% of advisers use AUM-based fee structures, while 11.1% use flat fees
   - This distribution has remained relatively stable over time with a slight trend toward more flat fee structures

2. **Fee Levels**:
   - Average effective fee for a $1M portfolio is 1.06-1.08%, while for a $5M portfolio it's 0.89-0.93%
   - Fee percentages decrease as threshold tiers increase, with Tier 1 averaging 1.17% and Tier 5 averaging 0.69%

3. **Fee Ranges**:
   - Fee ranges (vs. single values) are extremely rare, with only 2.03% of records having a range in Tier 1
   - Higher tiers have even fewer ranges, with most tiers having less than 0.05% of records with ranges

4. **Scale Benefits**:
   - Larger portfolios consistently benefit from lower effective fees, with an average reduction of 13%
   - This tiered pricing structure is consistent across most advisors

### Minimum Investment and Negotiability

5. **Minimum Investments**:
   - Only 20.1% of advisors specify a minimum investment requirement
   - The median minimum investment is $250,000, with 75% of minimums being $1 million or less

6. **Negotiable Fees**:
   - 61.6% of advisers indicate that their fees are negotiable, providing flexibility for clients
   - 38.4% have non-negotiable fee structures

### Filing Patterns and Data Quality

7. **Filing Patterns**:
   - Filing submissions show strong seasonality, with March having the highest number of filings each year
   - Filing volumes have increased over time, with recent years showing more consistent patterns

8. **Text Quality**:
   - Text length varies significantly by year, with more recent years showing longer, more detailed descriptions
   - 8.9% of records have zero text length, indicating potential data quality issues

## Data Irregularities

The analysis identified several irregularities in the data:

1. **Misplaced Information**: In 16.2% of records, fee information was not placed in the expected threshold columns.
2. **Multiple Products**: Some advisers have multiple products with different fee structures, requiring careful identification.
3. **Verification**: Only about 20% of the extracted information was verified, indicating potential quality issues.
4. **Inconsistent Formatting**: Fee thresholds and percentages were presented in various formats, requiring robust parsing logic.
5. **Missing Data**: Many records had incomplete information, particularly for minimum investments and negotiable thresholds.

## Data Cleaning Approach

The data cleaning process involved several key steps:

1. **Preserving Original Order**: The original row order from the source CSV files is maintained in the cleaned datasets.
2. **Identifier Extraction**: Adviser IDs and filing dates were extracted from filenames using regular expressions.
3. **Fee Structure Parsing**: Complex regular expressions were used to extract fee percentages and threshold amounts.
4. **Product Identification**: Multiple products were identified based on threshold patterns and lower bounds.
5. **Effective Fee Calculation**: A tiered calculation approach was used to determine effective fees for different portfolio sizes.
6. **Duplicate Removal**: For each adviser-year combination, only the latest filing was kept for the unique dataset.

## Setup and Installation

### Prerequisites

- Python 3.8 or higher
- Git (for cloning the repository)
- At least 8GB of RAM (recommended for processing large datasets)
- At least 2GB of free disk space

### Installation Steps

1. **Clone the repository**:
   ```bash
   git clone https://github.com/TanveerAhmedKhan/financial-advisor-fee-analysis.git
   cd financial-advisor-fee-analysis
   ```

2. **Create and activate a virtual environment** (recommended):

   Using venv:
   ```bash
   # On Windows
   python -m venv venv
   venv\Scripts\activate

   # On macOS/Linux
   python -m venv venv
   source venv/bin/activate
   ```

   Using uv (faster alternative):
   ```bash
   # Install uv if not already installed
   pip install uv

   # Create and activate environment
   uv venv .venv
   source .venv/bin/activate  # On Windows: .venv\Scripts\activate
   ```

3. **Install dependencies**:
   ```bash
   pip install -r requirements.txt
   ```

4. **Prepare the data directory structure**:
   ```bash
   mkdir -p data/raw data/processed
   ```

5. **Place raw data files**:
   - Copy your raw CSV files into the `data/raw` directory
   - The expected format is CSV files with fee structure information extracted from regulatory filings

### Running the Project

#### Running the Complete Pipeline

The data processing pipeline consists of three main steps that should be run in sequence:

```bash
# Step 1: Process CSV files individually
python src/process_csv_files.py

# Step 2: Combine processed files into consolidated datasets
python src/combine_processed_files.py

# Step 3: Add product structure analysis
python src/add_product_structure.py
```

This will:
1. Process all raw CSV files individually with enhanced percentage extraction
2. Combine processed files into consolidated datasets
3. Add comprehensive product structure analysis with fee range splitting

### Individual CSV Processing

The `process_csv_files.py` script provides a robust way to process each CSV file individually:

- Reads each CSV file from the `data/raw` directory
- Cleans and transforms the data (extracts percentages, standardizes values)
- Saves processed files to `data/processed` directory
- Maintains a record of processed files to avoid reprocessing
- Logs all processing activities to `data_processing.log`

This approach ensures that:
1. Original files remain untouched
2. Processing can be resumed if interrupted
3. New files can be added and processed without affecting existing processed files

### Data Consolidation

The `combine_processed_files.py` script combines all processed CSV files into a consolidated dataset:

1. `cleaned_fee_data_ordered.csv` - All processed records with original order preserved
   - Contains 285,714 observations
   - Includes 26,014 unique advisers based on ID1
   - Includes 110,363 unique advisers based on ID2

The `add_product_structure.py` script then processes this consolidated data to add product structure analysis:

2. `cleaned_fee_data_with_products.csv` - Final output with product structure analysis
   - Contains the same 285,714 observations with enhanced product identification
   - Includes successful fee range splitting for complex fee structures
   - Provides up to 8 distinct products per advisor record

This processing pipeline ensures that:
1. All unique advisers are included in the final datasets
2. The original order of the data is preserved
3. Complex fee structures are properly identified and split into separate products
4. Enhanced percentage extraction handles various fee formats

### Calculating Effective Fees

The `calculate_effective_fee.py` script demonstrates how to calculate the effective fee for different portfolio sizes based on a tiered fee structure:

```
Example Fee Structure:
  $0.00 - $1,000,000.00 at 1.00%
  $1,000,000.00 - $5,000,000.00 at 0.75%

Effective Fees for Different Portfolio Sizes:
  $500,000.00: 1.00% ($5,000.00 annually)
  $1,000,000.00: 1.00% ($10,000.00 annually)
  $2,500,000.00: 0.85% ($21,250.00 annually)
  $5,000,000.00: 0.80% ($40,000.00 annually)
  $10,000,000.00: 0.78% ($77,500.00 annually)
```



## Recent Updates

### June 2024 Updates

1. **Enhanced Product Structure Analysis**:
   - Created `add_product_structure.py` for comprehensive product identification
   - Implemented special case handling for fee range splitting
   - Added robust product identification across multiple complexity phases
   - Enhanced percentage extraction to handle various formats

2. **Improved Fee Range Processing**:
   - Successfully split single-tier fee ranges into separate products
   - Enhanced "Under $X" pattern detection and conversion
   - Improved currency format parsing (K, M, B suffixes)
   - Better handling of fee ranges and multiple product structures

3. **Pipeline Optimization**:
   - Streamlined three-step processing pipeline
   - Enhanced data consolidation and product extraction
   - Improved error handling and validation
   - Comprehensive cleanup and documentation updates

### May 2025 Updates

1. **GitHub Repository Setup**:
   - Created a GitHub repository for the project at [TanveerAhmedKhan/financial-advisor-fee-analysis](https://github.com/TanveerAhmedKhan/financial-advisor-fee-analysis)
   - Configured .gitignore to exclude large data files and logs
   - Organized the repository structure for better navigation and understanding

2. **Fixed Data Consolidation Issues**:
   - Corrected the consolidated dataset to ensure the correct number of observations and unique advisers
   - Fixed the cleaned_fee_data_ordered.csv file to contain 285,714 observations (previously 752,013)
   - Ensured all 110,363 unique advisers are included in the final dataset

3. **Enhanced Data Processing Pipeline**:
   - Created a robust pipeline for processing raw CSV files
   - Implemented a consolidation process that preserves the original order of the data
   - Added verification steps to ensure data integrity
   - Improved error handling and logging

4. **Enhanced Data Analysis Capabilities**:
   - Comprehensive fee structure analysis with statistical insights
   - Advanced product identification and fee range splitting
   - Detailed data quality assessment and validation
   - Statistical analysis of fee patterns and trends

5. **Standardized Column Structure**:
   - Fixed inconsistency in column counts across processed files
   - Ensured all processed files have the same 61 columns regardless of source
   - Added consistent handling of missing columns to maintain data integrity
   - Regenerated all processed files and consolidated datasets

## Future Work

Potential areas for further analysis:

1. **Adviser Characteristics**: Analyze how fee structures vary by adviser size, client type, and investment strategy.
2. **Geographic Variations**: Examine regional differences in fee structures and minimums.
3. **Longitudinal Analysis**: Track how individual advisers change their fee structures over time.
4. **Competitive Positioning**: Analyze how fee structures relate to adviser growth and client retention.
5. **Regulatory Impact**: Investigate how regulatory changes affect fee structures and disclosure practices.
6. **Machine Learning Models**: Develop predictive models for fee structures based on adviser characteristics.
7. **Text Analysis**: Analyze the original text descriptions to identify patterns in fee disclosure language.
8. **Data Sharing**: Implement Git LFS (Large File Storage) to include the large consolidated datasets in the repository.
9. **Visualization Development**: Create comprehensive visualization scripts to generate charts and graphs from the processed data.
10. **Interactive Dashboard**: Develop a web-based dashboard for interactive exploration of the fee data.
11. **API Development**: Create an API to allow programmatic access to the fee data and analysis results.

## Contributing

Contributions to this project are welcome! Please feel free to submit a Pull Request.

## License

This project is available under the MIT License. See the LICENSE file for more details.
